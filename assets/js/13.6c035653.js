(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{381:function(s,a,t){"use strict";t.r(a);var e=t(45),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"overthewire-leviathan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#overthewire-leviathan"}},[s._v("#")]),s._v(" OverTheWire leviathan")]),s._v(" "),t("p",[s._v("Pour tous les challenges :")]),s._v(" "),t("blockquote",[t("p",[s._v("There is no information for this level, intentionally.")])]),s._v(" "),t("h2",{attrs:{id:"level-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-0"}},[s._v("#")]),s._v(" Level 0")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2223")]),s._v("  leviathan0@leviathan.labs.overthewire.org\n")])])]),t("p",[t("code",[s._v("leviathan0:leviathan0")])]),s._v(" "),t("h2",{attrs:{id:"level-0-→-level-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-0-→-level-1"}},[s._v("#")]),s._v(" Level 0 → Level 1")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -la\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" .backup/bookmarks.html "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" levianthan1\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("DT"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("A "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HREF")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is rioGegei8m"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADD_DATE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1155384634"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LAST_CHARSET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ISO-8859-1"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rdf:#'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2wIU71")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("password to leviathan"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v("<")]),s._v("/A"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("p",[s._v("Pass : "),t("code",[s._v("rioGegei8m")])]),s._v(" "),t("p",[t("code",[s._v("leviathan1:rioGegei8m")])]),s._v(" "),t("h2",{attrs:{id:"level-1-→-level-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-1-→-level-2"}},[s._v("#")]),s._v(" Level 1 → Level 2")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -la\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("\ndrwxr-xr-x  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root       root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Aug "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" root       root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Aug "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n-rw-r--r--  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root       root        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("220")]),s._v(" May "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v(" .bash_logout\n-rw-r--r--  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root       root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3526")]),s._v(" May "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v(" .bashrc\n-r-sr-x---  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" leviathan2 leviathan1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7452")]),s._v(" Aug "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v(" check\n-rw-r--r--  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root       root        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("675")]),s._v(" May "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2017")]),s._v(" .profile\n")])])]),t("p",[s._v("Il y a un binaire "),t("code",[s._v("check")]),s._v(" que nous pouvons lancer, et qui est détenu par levianthan2.")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ltrace ./check\n__libc_start_main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x804853b, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", 0xffffd784, 0x8048610 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unfinished "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nprintf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password: "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\ngetchar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", 0x65766f6c, 0x646f6700password: "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("116")]),s._v("\ngetchar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", 0x65766f6c, 0x646f6700"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v("\ngetchar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", 0x65766f6c, 0x646f6700"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("115")]),s._v("\nstrcmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tes"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nputs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Wrong password, Good Bye ..."')]),s._v("Wrong password, Good Bye "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("\n+++ exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("status "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" +++\n")])])]),t("p",[s._v("On voit qu'il compare notre entrée "),t("code",[s._v("test")]),s._v(" à "),t("code",[s._v("sex")]),s._v(". Donc le password est "),t("code",[s._v("sex")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ./check\npassword: sex\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12002")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("leviathan2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("leviathan1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("leviathan1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("On est ainsi leviathan2.\nAinsi :")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/leviathan_pass/leviathan2\nougahZi8Ta\n")])])]),t("p",[s._v("Pass : "),t("code",[s._v("ougahZi8Ta")])]),s._v(" "),t("p",[t("code",[s._v("levianthan2:ougahZi8Ta")])]),s._v(" "),t("h2",{attrs:{id:"level-2-→-level-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-2-→-level-3"}},[s._v("#")]),s._v(" Level 2 → Level 3")]),s._v(" "),t("p",[s._v("Encore un binaire, qu'on va lancer à l'aide de "),t("code",[s._v("ltrace")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ltrace ./printfile "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n__libc_start_main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x804852b, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", 0xffffd784, 0x8048610 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unfinished "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\naccess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" -1\nputs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You cant have that file..."')]),s._v("You cant have that file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v("\n+++ exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("status "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" +++\n")])])]),t("p",[s._v("On voit qu'il utilise la fonction "),t("code",[s._v("access")]),s._v(" qui vérifie les permissions du fichier (voir la "),t("a",{attrs:{href:"https://linux.die.net/man/2/access",target:"_blank",rel:"noopener noreferrer"}},[s._v("man page de access"),t("OutboundLink")],1),s._v(" pour savoir comment cette commande fonctionne).")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /tmp/a\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bbb"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /tmp/a/test\n")])])]),t("p",[s._v("Et :")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ltrace ./printfile /tmp/a/test\n__libc_start_main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x804852b, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", 0xffffd764, 0x8048610 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unfinished "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\naccess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/tmp/a/test"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsnprintf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/cat /tmp/a/test"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("511")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/cat %s"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/tmp/a/test"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\ngeteuid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12002")]),s._v("\ngeteuid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12002")]),s._v("\nsetreuid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12002")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12002")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsystem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/cat /tmp/a/test"')]),s._v("bbb\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("no "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n--- SIGCHLD "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Child exited"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ---\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". system resumed"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                                                                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n+++ exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("status "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" +++\n")])])]),t("p",[s._v("Ici on voit qu'il permet de lire le contenu du fichier renseigné en tant que levianthan3.\nAinsi :")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /etc/levianthan_pass/levianthan3 a\n$ ./printfile /tmp/a/a\n")])])]),t("p",[s._v("Mais cela ne fonctionne pas. Mais on sait que "),t("code",[s._v("cat")]),s._v(" est utilisé et que si on fait "),t("code",[s._v("cat a b")]),s._v(", les fichiers a et b vont s'afficher.\nEt ainsi :")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /tmp/a\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" b  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Il faut créer un fichier "a b" car la commande access() va verifier les permissions du fichier mis en argument')]),s._v("\n$ ~/printfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a b"')]),s._v("\nAhdiemoo1j\n")])])]),t("p",[s._v("Pass : "),t("code",[s._v("Ahdiemoo1j")])]),s._v(" "),t("p",[t("code",[s._v("levianthan3:Ahdiemoo1j")])]),s._v(" "),t("h2",{attrs:{id:"level-3-→-level-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-3-→-level-4"}},[s._v("#")]),s._v(" Level 3 → Level 4")]),s._v(" "),t("p",[s._v("Pour changer, encore un binaire "),t("code",[s._v("level3")]),s._v(" ! On va utiliser l'outil "),t("code",[s._v("ltrace")]),s._v(", car on peut voir que c'est un executable dynamique (voir avec "),t("code",[s._v("file level3")]),s._v(").")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ltrace ./level3\n__libc_start_main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x8048618, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", 0xffffd784, 0x80486d0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unfinished "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nstrcmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"h0no33"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kakaka"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" -1\nprintf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Enter the password> "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\nfgets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Enter the password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v(", 0xf7fc55a0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 0xffffd590\nstrcmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"snlprintf'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nputs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bzzzzzzzzap. WRONG"')]),s._v("bzzzzzzzzap. WRONG\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("\n+++ exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("status "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" +++\n")])])]),t("p",[s._v("On voit le "),t("code",[s._v("strcmp")]),s._v(' entre le password qu\'on renseigne et la chaine de caractères "snlprintf".\nDonc :')]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ./level3\nEnter the password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" snlprintf\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("You've got shell"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12004")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("leviathan4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12003")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("leviathan3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12003")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("leviathan3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/leviathan_pass/leviathan4\nvuH0coox6m\n")])])]),t("p",[s._v("Pass : "),t("code",[s._v("vuH0coox6m")])]),s._v(" "),t("p",[t("code",[s._v("levianthan4:vuH0coox6m")])]),s._v(" "),t("h2",{attrs:{id:"level-4-→-level-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-4-→-level-5"}},[s._v("#")]),s._v(" Level 4 → Level 5")]),s._v(" "),t("p",[s._v("Dossier caché "),t("code",[s._v(".trash")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" bin\nbin: setuid ELF "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("-bit LSB executable, Intel "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80386")]),s._v(", version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SYSV"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", dynamically linked, interpreter /lib/ld-linux.so.2, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" GNU/Linux "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.6")]),s._v(".32, BuildID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sha1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("00ce1aa55b0e691470f61baff0ee59a6c33fcb50, not stripped\n$ ltrace ./bin\n__libc_start_main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0x80484bb, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", 0xffffd774, 0x80485b0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unfinished "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nfopen"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/leviathan_pass/leviathan5"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"r"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n+++ exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("status "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" +++\n$ ./bin\n01010100 01101001 01110100 01101000 00110100 01100011 01101111 01101011 01100101 01101001 00001010\n")])])]),t("p",[s._v("Et en ASCII on trouve "),t("code",[s._v("Tith4cokei")])]),s._v(" "),t("p",[s._v("Pass : "),t("code",[s._v("Tith4cokei")])]),s._v(" "),t("p",[t("code",[s._v("levianthan5:Tith4cokei")])]),s._v(" "),t("h2",{attrs:{id:"level-5-→-level-6"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-5-→-level-6"}},[s._v("#")]),s._v(" Level 5 → Level 6")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" leviathan5\nleviathan5: setuid ELF "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("-bit LSB executable, Intel "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80386")]),s._v(", version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SYSV"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", dynamically linked, interpreter /lib/ld-linux.so.2, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" GNU/Linux "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.6")]),s._v(".32, BuildID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sha1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("414fe0634bbd08f446816d4da55ea9a43484fc35, not stripped\n$ ~/leviathan5\nCannot "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" /tmp/file.log\n")])])]),t("p",[s._v("Par example, on peut faire :")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /etc/leviathan_pass/leviathan6 /tmp/file.log\n$ ~/leviathan5\nUgaoFee4li\n")])])]),t("p",[s._v("Pass : "),t("code",[s._v("UgaoFee4li")])]),s._v(" "),t("p",[t("code",[s._v("levianthan6:UgaoFee4li")])]),s._v(" "),t("h2",{attrs:{id:"level-6-→-level-7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-6-→-level-7"}},[s._v("#")]),s._v(" Level 6 → Level 7")]),s._v(" "),t("p",[s._v("Simple, on bruteforce :")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("i")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("text")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Wrong"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Wrong"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Test : '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$i")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" ./leviathan6 "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$i")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("i")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$((")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("))")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/leviathan_pass/leviathan7\nahy7MaeBo9\n")])])]),t("p",[s._v("Pass : "),t("code",[s._v("ahy7MaeBo9")])]),s._v(" "),t("p",[t("code",[s._v("levianthan7:ahy7MaeBo9")])]),s._v(" "),t("h2",{attrs:{id:"level-7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#level-7"}},[s._v("#")]),s._v(" Level 7")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nCONGRATULATIONS\n")])])]),t("p",[s._v("Et voilà.")])])}),[],!1,null,null,null);a.default=n.exports}}]);